# Workflow проекта pg-ha-patroni

## Полный цикл работы проекта


┌──────────────┐
│ Git clone    │
│ pg-ha-patroni│
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ make setup   │
│ (системные)  │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ make init    │
│ (venv, ansible, .envrc) │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ direnv allow │
│ (активация venv и переменных) │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ make up      │
│ (поднять кластер) │
└──────┬───────┘
       │
       ▼
┌──────────────┐
│ make ansible │
│ (проверка доступности) │
└──────┬───────┘
       │
       ▼
┌───────────────┐
│ Кластер       │
│ работает      │
└──────┬────────┘
       │
 ┌─────┴────────┐
 │              │
 ▼              ▼
make halt     make destroy
│              │
│ После halt можно выключить компьютер
│ и потом продолжить работу с кластером
│ используя make up / vagrant up
└──────────────┘

### Пояснения

- make halt — остановка VM, сохраняется состояние кластера на диски
- make destroy — удаление всего кластера и информации о нем с дисков
- Диаграмма показывает полный цикл: установка → инициализация → поднятие → проверка → управление кластером
