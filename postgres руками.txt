# Подключаемся к db2
vagrant ssh db2

# Переключаемся на root для удобства
sudo -i

# Обновляем систему
#dnf update -y

# Устанавливаем необходимые пакеты
dnf install -y wget curl gnupg2 openssl selinux-policy-targeted

dnf install epel-release

dnf config-manager --set-enabled ol8_codeready_builder

dnf makecache

# Устанавливаем репозиторий PostgreSQL для Oracle Linux 8
dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm

# Отключаем модуль стандартного PostgreSQL (если есть)
dnf -qy module disable postgresql

# Устанавливаем perl модули из EPEL
dnf install -y perl-IPC-Run

# Устанавливаем PostgreSQL 15 и утилиты
dnf install -y postgresql15-server postgresql15-contrib postgresql15-devel

# Инициализируем базу данных
/usr/pgsql-15/bin/postgresql-15-setup initdb

# Запускаем и включаем автозагрузку
systemctl enable postgresql-15
systemctl start postgresql-15

# Проверяем статус
systemctl status postgresql-15